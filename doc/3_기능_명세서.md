# 기능 명세서 (Functional Specification)

## 1. 개요
본 문서는 AdvanceKeep 애플리케이션의 상세 기능을 정의합니다. 각 기능의 입력, 처리, 출력을 명시합니다.

## 2. 상세 기능 목록

### F-01: 메모 작성
-   **Description**: 사용자가 새로운 메모를 생성하는 기능
-   **Input**: 제목(텍스트), 내용(텍스트/마크다운), 이미지(파일 업로드)
-   **Process**:
    1. 사용자가 입력창 클릭 시 확장됨
    2. 내용 입력 후 '닫기' 또는 외부 클릭 시 저장 요청
    3. 백엔드 API (`POST /notes`) 호출
-   **Output**: 메인 화면 목록에 새로운 메모 카드 추가

### F-02: 메모 수정
-   **Description**: 기존 메모의 내용을 변경하는 기능
-   **Input**: 수정할 제목, 내용, 이미지
-   **Process**:
    1. 메모 카드 클릭 시 모달 창 오픈
    2. 내용 수정 후 저장
    3. 백엔드 API (`PUT /notes/:id` 또는 `PATCH`) 호출
-   **Output**: 변경된 내용이 반영된 메모 카드 표시

### F-03: 메모 삭제 및 복원
-   **Description**: 메모를 휴지통으로 보내거나 복원하는 기능
-   **Process**:
    1. 메모 카드의 '삭제' 아이콘 클릭 -> `isTrashed: true` 업데이트
    2. 휴지통에서 '복원' 아이콘 클릭 -> `isTrashed: false` 업데이트
    3. 휴지통에서 '영구 삭제' 클릭 -> DB에서 데이터 완전 삭제 (`DELETE /notes/:id`)
-   **Output**: 해당 메모가 목록에서 사라지거나 휴지통/메인으로 이동

### F-04: 이미지 업로드
-   **Description**: 로컬 이미지를 메모에 첨부하는 기능
-   **Input**: 이미지 파일 (JPG, PNG 등)
-   **Process**:
    1. 사용자가 이미지 파일 선택
    2. Firebase Storage에 업로드 및 다운로드 URL 획득
    3. 메모 데이터의 `images` 배열에 URL 저장
-   **Output**: 메모 카드 상단에 첨부된 이미지 표시

### F-05: 리스트/그리드 뷰 전환
-   **Description**: 메모 목록의 레이아웃을 변경하는 기능
-   **Input**: 헤더의 뷰 전환 토글 버튼 클릭
-   **Process**: 전역 상태(Context)의 `viewMode` 값을 `list` <-> `grid` 변경
-   **Output**:
    -   List View: 메모가 세로로 일렬 배치
    -   Grid View: Masonry 레이아웃으로 빈 공간 없이 배치

### F-06: 검색
-   **Description**: 메모를 검색하는 기능
-   **Input**: 검색어
-   **Process**: 메모 생성/수정 시 텍스트 인덱싱 또는 클라이언트 사이드 필터링 수행
-   **Output**: 검색어가 제목 또는 내용에 포함된 메모만 필터링하여 표시, 일치하는 텍스트는 노란색으로 하이라이트

### F-07: 메모 고정/해제
-   **Description**: 중요한 메모를 상단에 고정하는 기능
-   **Input**: 메모 카드의 핀 아이콘 클릭
-   **Process**:
    1. `isPinned: true` 속성 설정
    2. 고정된 메모는 "고정됨" 섹션에 표시
    3. 해제 시 `isPinned: false`로 변경
-   **Output**: 고정된 메모가 상단 영역에 분리되어 표시

### F-08: 메모 공유
-   **Description**: 다른 사용자와 메모를 공유하는 기능
-   **Input**: 공유할 사용자의 이메일
-   **Process**:
    1. 메모 카드의 공유 버튼 클릭
    2. 이메일 입력 모달 표시
    3. 해당사용자의 ID를 메모의 `sharedWith` 배열에 추가
    4. Firebase에 업데이트
-   **Output**: 공유 배지 표시, 공유받은 사용자는 해당 메모 조회/수정 가능

### F-09: 이미지 확대 보기 (Lightbox)
-   **Description**: 첨부된 이미지를 전체 화면으로 확대하여 보는 기능
-   **Input**: 이미지 클릭
-   **Process**:
    1. 메모 카드, 등록 폼, 수정 모달의 이미지 클릭
    2. `yet-another-react-lightbox` 라이브러리로 전체 화면 모달 표시
    3. 여러 이미지가 있을 경우 좌우 화살표로 탐색 가능
-   **Output**: 전체 화면 이미지 뷰어, ESC 키 또는 배경 클릭으로 닫기

### F-10: 실시간 데이터 동기화
-   **Description**: 사용자의 작업이 실시간으로 모든 클라이언트에 반영되는 기능
-   **Process**:
    1. `onSnapshot` 리스너를 통해 Firestore의 변경 사항을 구독
    2. 데이터 변경 발생 시 자동으로 UI 상태(State) 업데이트
-   **Output**: 새로고침 없이 공유받은 메모가 나타나거나 수정된 내용이 즉시 반영됨

### F-11: 메모 배경색 변경
-   **Description**: 메모의 배경색을 변경하여 시각적으로 구분하는 기능
-   **Input**: 배경색 변경 버튼(물방울 아이콘) 클릭 시 나타나는 색상 팔레트에서 색상 선택
-   **Process**:
    1. 사용자가 12가지 파스텔톤 색상 중 하나를 선택
    2. 선택 즉시 폼 또는 모달의 배경색이 변경되어 프리뷰 제공
    3. 저장 시 메모 데이터의 `color` 필드에 헥사코드(Hex code) 저장
-   **Output**: 메모 카드의 배경이 선택한 색상으로 표시됨

### F-12: 구글 소셜 로그인
-   **Description**: 구글 계정을 사용하여 간편하게 로그인하는 기능
-   **Input**: "Google로 로그인" 버튼 클릭
-   **Process**:
    1. Firebase Authentication의 Google Provider를 통해 팝업 창 표시
    2. 사용자가 구글 계정 선택 및 인증
    3. 인증 성공 시 사용자 정보를 Firestore에 저장 (신규 사용자인 경우)
    4. 로그인 상태 유지 옵션에 따라 세션 지속성 설정
-   **Output**: 로그인 완료 후 메인 화면으로 이동, 사용자 프로필 표시

### F-13: 라벨 관리
-   **Description**: 메모를 분류하기 위한 라벨을 생성, 수정, 삭제하는 기능
-   **Input**: 사이드바의 "라벨 수정" 버튼 클릭
-   **Process**:
    1. 라벨 관리 모달 표시
    2. (생성) 새 라벨 이름 입력 후 추가
    3. (수정) 기존 라벨 이름 옆의 연필 아이콘 클릭하여 이름 변경
    4. (삭제) 라벨 옆의 삭제 버튼 클릭 -> 해당 라벨 데이터 삭제 (메모와의 연결도 해제)
-   **Output**: 사이드바에 라벨 목록 업데이트 및 라벨별 페이지 생성

### F-14: 라벨 필터링
-   **Description**: 특정 라벨이 부착된 메모만 모아서 보는 기능
-   **Input**: 사이드바의 라벨 메뉴 클릭
-   **Process**:
    1. URL이 `/label/:labelId`로 변경
    2. 해당 `labelId`를 포함하는 메모 필터링
    3. **특이사항**: 라벨 보기에서도 보관된(Archived) 메모는 표시하지 않음 (활성 메모만 표시)
-   **Output**: 선택한 라벨이 붙은 메모들만 그리드/리스트 뷰로 표시


### F-15: 체크리스트 관리
-   **Description**: 할 일 목록(체크리스트)을 작성하고 관리하는 기능
-   **Input**: 체크리스트 아이템 텍스트, 체크박스 선택
-   **Process**:
    1.  모드 전환 또는 할 일 목록 페이지에서 체크리스트 모드 진입
    2.  항목 추가 (Enter 키), 삭제 (Backspace 또는 삭제 버튼)
    3.  체크박스 선택 시 '완료된 항목'으로 시각적 분리 및 하단 이동

### F-16: 로컬 데이터 백업 및 복구
-   **Description**: 사용자의 모든 메모와 라벨 데이터를 로컬 파일로 백업하고, 필요 시 복구하는 기능
-   **Input**: 헤더의 구름 아이콘 메뉴 > "내 컴퓨터에 백업" 또는 "내 컴퓨터에서 복구"
-   **Process**:
    -   **백업 (Export)**:
        1.  사용자 ID에 연결된 모든 메모(휴지통/보관함 포함)와 라벨 데이터 조회
        2.  JSON 형식으로 데이터 직렬화
        3.  `advancekeep_YYYYMMDD_HHMMSS.json` 파일명으로 로컬 다운로드
        4.  (지원 브라우저의 경우) '다른 이름으로 저장' 대화상자 표시
    -   **복구 (Import)**:
        1.  사용자가 `.json` 백업 파일 선택
        2.  파일 내용 파싱 및 유효성 검증
        3.  데이터 복구 전 기존 데이터 삭제 및 덮어쓰기 경고 (사용자 확인)
        4.  Firestore 배치 처리(Batch)를 통해 대용량 데이터 안전하게 복원 (청크 분할)
-   **Output**: 
    -   백업 시: 로컬 스토리지에 `.json` 파일 생성
    -   복구 시: 앱 데이터가 백업 시점의 상태로 완전히 동기화됨

### F-17: 휴지통 자동 비우기
-   **Description**: 휴지통에 보관된지 오래된 메모를 자동으로 영구 삭제하는 기능
-   **Input**: 없음 (자동 실행)
-   **Process**:
    1.  메모 삭제(휴지통 이동) 시 `deletedAt` 타임스탬프 기록
    2.  복구 시 `deletedAt` 초기화
    3.  앱 구동 시 30일이 경과한 메모를 감지하여 영구 삭제
-   **Output**: 30일이 지난 메모 영구 제거 및 저장 공간 확보

### F-18: 검색 엔진 최적화 (SEO)
-   **Description**: 검색 엔진 노출 및 소셜 미디어 공유 최적화
-   **Process**:
    1.  `robots.txt`: 모든 크롤러 접근 허용 (`Allow: /`)
    2.  `meta tags`: 제목, 설명, 키워드, Open Graph(공유 미리보기) 태그 적용
-   **Output**: 링크 공유 시 미리보기 카드 표시, 검색 엔진 수집 허용

### F-19: 모바일 앱 지원 (Android/iOS)
-   **Description**: 웹 애플리케이션을 네이티브 모바일 앱(Android, iOS)으로 패키징하여 배포 및 실행하는 기능
-   **Process**:
    1.  Capacitor 런타임이 웹뷰(WebView) 내에서 리액트 앱 실행
    2.  네이티브 브릿지를 통해 디바이스 기능(카메라, 파일 시스템 등) 접근 (필요 시)
-   **Output**: Android APK/AAB 및 iOS IPA 파일 생성 가능

